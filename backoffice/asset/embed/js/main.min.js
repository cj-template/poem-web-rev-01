import htmx from"./lib/htmx/htmx.esm.js";import Alpine from"./lib/alpine/alpine.esm.js";export function start(){Alpine.store("util",{formatToLocalTime(e){let t=new Date(e.innerHTML);if(isNaN(t.getTime())||t.toString()==="Invalid Date"||t.getTime()===0)return;e.innerHTML=t.toLocaleString()}}),Alpine.store("nav",{async clearActive(){let e=document.getElementsByClassName("nav-item");for(let t of e)t.classList.remove("nav-item-active")},async updateActive(e){if(await this.clearActive(),e==="")return;let t=document.getElementById(e);t!==null&&t.classList.add("nav-item-active")},async updateActiveByElement(e){e.dataset.tag&&await this.updateActive(e.dataset.tag),e.remove()}}),Alpine.store("csrf",{token:"",updateToken(e){this.token!==e&&(this.token=e)},updateTokenByElement(e,t=!0){e.dataset.csrf&&this.updateToken(e.dataset.csrf),t&&e.remove()},fetch(e,t={}){return fetch(e,{...t,headers:{...t.headers,"X-Csrf-Token":this.token}})}}),htmx.on("htmx:responseError",function(e){if(e.detail.xhr.status===422)return;let t=document.createElement("pre");t.classList.add("pre"),t.innerText=e.detail.xhr.responseText;let n=document.createElement("div");n.innerHTML="<h1>Error "+e.detail.xhr.status+" "+e.detail.xhr.statusText+"</h1><br>",n.appendChild(t),htmx.swap("#main-content",n.outerHTML,{swapStyle:"innerHTML",swapDelay:0,settleDelay:0,transition:!1,ignoreTitle:!0,head:"<title>"+e.detail.xhr.status+" "+e.detail.xhr.statusText+"</title>",scroll:"top",show:"#main-content",focusScroll:!0})}),document.body.addEventListener("htmx:configRequest",function(e){e.detail.verb!=="get"&&e.detail.verb!=="head"&&(e.detail.headers["X-Csrf-Token"]=Alpine.store("csrf").token)}),window.Alpine=Alpine,window.htmx=htmx,Alpine.start()}